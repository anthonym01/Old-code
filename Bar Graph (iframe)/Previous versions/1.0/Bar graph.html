<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<link rel="icon" href="favicon.png" type="image/png" sizes="32x32">
<style>
body{
    padding: 0px;
    margin:0px;
}
        /*  GraphIPO menu*/
IPOmenu{
    position: fixed;
    top:0;
    left:5%;
    width:90%;
    height:8%;
    z-index:50;
}
.inputwarning{
    display:none;
    top:0;
    left:0;
    padding: 5px;
    font-size:3vh;
    color:red;
    background-color: black;
    border-bottom:1px solid red;
    border-right:1px solid red;
    border-left:1px solid red;
    border-radius: 15px;
}
.inforput{
    height:95%;
    width:20%;
    border-top:none;
    border-left:none;
    border-right:none;
    border-bottom: solid;
    border-width: 1vh;
    border-color:black;
    font-size:8vh;
    align-content: center;
    align-self: baseline;
    text-align:center;
    float:left;
}
.inforput:hover{
    border-color:rgb(62, 129, 255);
    color:rgb(62, 129, 255);
    text-shadow:0px 0px 25px rgba(62, 130, 255, 0.507);
}
 

/*  Graph tags, Copy these to your document*/

.grapgcontainer{
    position: fixed;
    top:8%;
    width:90%;
    height:90%;
    left:5%;
    overflow:hidden;
    border:1vh solid black;
}
.graphtable{width:100%;height:100%;}

.barcontainer{
    width:100%;
}

.bar{
    overflow: hidden;
    width:0%;
    background-color: black;
    height:95%;
    text-align:center;
    font-size:14vh;
    white-space: nowrap;
    vertical-align:middle;
    color:rgb(255, 255, 255);
    text-shadow: 0px 0px 30px #000000;
    border-radius: 0px 25px 25px 0px ;
    transition: width,background-color;
    transition-duration: 500ms;
}</style>
<title>Graph example</title>
</head>
<body>
	<IPOmenu>
		<input type="text" placeholder="bar #1" class="inforput" id="barput1">
		<input type="text" placeholder="bar #2" class="inforput" id="barput2">
		<input type="text" placeholder="bar #3" class="inforput" id="barput3">
		<input type="text" placeholder="bar #4" class="inforput" id="barput4">
		<input type="text" placeholder="bar #5" class="inforput" id="barput5"><div class="inputwarning" id="error">Not a number!!</div>
	</IPOmenu>
	<!--Copy this into your document-->
	<div class="grapgcontainer">
		<table class="graphtable">
			<tr>
				<th class="barcontainer">
					<div class="bar" id="bar1"></div>
				</th>
			</tr>
			<tr>
				<th class="barcontainer">
					<div class="bar" id="bar2"></div>
				</th>
			</tr>
			<tr>
				<th class="barcontainer">
					<div class="bar" id="bar3"></div>
				</th>
			</tr>
			<tr>
				<th class="barcontainer">
					<div class="bar" id="bar4"></div>
				</th>
			</tr>
			<tr>
				<th class="barcontainer">
					<div class="bar" id="bar5"></div>
				</th>
			</tr>
		</table>
	</div>
<script type="text/javascript">
window.addEventListener('load',function(){
    if(localStorage.getItem("cfg")){
        config_handler.load();
        config.loadcount++;
        console.log('Page loaded '+config.loadcount);
        config_handler.store();
    }else{
        config_handler.store();
        config.loadcount++;
        console.log('Page loaded '+config.loadcount);
        config_handler.load();
    }
});

var config={
    theme:"",
    loadcount:0,
    bar1:10,
    bar2:30,
    bar3:50,
    bar4:70,
    bar5:100,
}
config_handler={
    load:function(){
        config = JSON.parse(localStorage.getItem("cfg"));
        document.getElementById('barput1').value=config.bar1;
        document.getElementById('barput2').value=config.bar2;
        document.getElementById('barput3').value=config.bar3;
        document.getElementById('barput4').value=config.bar4;
        document.getElementById('barput5').value=config.bar5;
        tablegeneration.bars();
    },
    store:function(){
        localStorage.setItem("cfg",JSON.stringify(config));
    },
    delete:function(){
        localStorage.clear("cfg");
    },
    savevalues:function(){
        config.bar1=document.getElementById('barput1').value;
        config.bar2=document.getElementById('barput2').value;
        config.bar3=document.getElementById('barput3').value;
        config.bar4=document.getElementById('barput4').value;
        config.bar5=document.getElementById('barput5').value;
        this.store();
    }
}

table_input_handling = {
    input1check:document.getElementById('barput1').addEventListener('keydown',function(){
        setTimeout(function(){
            var barput1 = document.getElementById('barput1').value;
            if(!isNaN(barput1)){
                //checkval();
                tablegeneration.bars();
                document.getElementById('error').style.display="none";
                document.getElementById('barput1').style=""
            }else{
                document.getElementById('error').style.display="block";
                document.getElementById('barput1').style="color:red;border-color:red;"
            }
        },50);
    }),
    input1check:document.getElementById('barput2').addEventListener('keydown',function(){
        setTimeout(function(){
            var barput1 = document.getElementById('barput2').value;
            if(!isNaN(barput1)){
                //checkval();
                tablegeneration.bars();
                document.getElementById('error').style.display="none";
                document.getElementById('barput2').style=""
            }else{
                document.getElementById('error').style.display="block";
                document.getElementById('barput2').style="color:red;border-color:red;"
            }
        },50);
    }),
    input1check:document.getElementById('barput3').addEventListener('keydown',function(){
        setTimeout(function(){
            var barput1 = document.getElementById('barput3').value;
            if(!isNaN(barput1)){
                //checkval();
                tablegeneration.bars();
                document.getElementById('error').style.display="none";
                document.getElementById('barput3').style=""
            }else{
                document.getElementById('error').style.display="block";
                document.getElementById('barput3').style="color:red;border-color:red;"
            }
        },50);
    }),
    input1check:document.getElementById('barput4').addEventListener('keydown',function(){
        setTimeout(function(){
            var barput1 = document.getElementById('barput4').value;
            if(!isNaN(barput1)){
                //checkval();
                tablegeneration.bars();
                document.getElementById('error').style.display="none";
                document.getElementById('barput4').style=""
            }else{
                document.getElementById('error').style.display="block";
                document.getElementById('barput4').style="color:red;border-color:red;"
            }
        },50);
    }),
    input1check:document.getElementById('barput5').addEventListener('keydown',function(){
        setTimeout(function(){
            var barput1 = document.getElementById('barput5').value;
            if(!isNaN(barput1)){
                //checkval();
                tablegeneration.bars();
                document.getElementById('error').style.display="none";
                document.getElementById('barput5').style=""
            }else{
                document.getElementById('error').style.display="block";
                document.getElementById('barput5').style="color:red;border-color:red;"
            }
        },50);
    }),
    trigergeneration:function(){
        tablegeneration.bars();
    }
}

/*This object controls the generation of the table*/
tablegeneration={
    bars:function(){//generates the bars
        //gets numbers
        var bar1 = Number(document.getElementById('barput1').value);
        var bar2 = Number(document.getElementById('barput2').value);
        var bar3 = Number(document.getElementById('barput3').value);
        var bar4 = Number(document.getElementById('barput4').value);
        var bar5 = Number(document.getElementById('barput5').value);
        //displays numbers on bar
        document.getElementById('bar1').innerHTML=bar1;
        document.getElementById('bar2').innerHTML=bar2;
        document.getElementById('bar3').innerHTML=bar3;
        document.getElementById('bar4').innerHTML=bar4;
        document.getElementById('bar5').innerHTML=bar5;

        config_handler.savevalues();//saves config
        var totalvalue = bar1+bar2+bar3+bar4+bar5;
        console.log(bar1,bar2,bar3,bar4,bar5,'Tatal: '+totalvalue);
        
        //finds percentages
        var bar1cent=bar1/totalvalue*100;
        var bar2cent=bar2/totalvalue*100;
        var bar3cent=bar3/totalvalue*100;
        var bar4cent=bar4/totalvalue*100;
        var bar5cent=bar5/totalvalue*100;
        console.log('Raw percentages: ',bar1cent,bar2cent,bar3cent,bar4cent,bar5cent);

        //determines largest percentage
        var largest=0;
        if(bar1cent>largest){largest=bar1cent}
        if(bar2cent>largest){largest=bar2cent}
        if(bar3cent>largest){largest=bar3cent}
        if(bar4cent>largest){largest=bar4cent}
        if(bar5cent>largest){largest=bar5cent}
        console.log('Largest: '+largest);

        //narmalizes percentages to with the largest value being 100% e.g. 100/69*69 = 100%, and 100/69 * 50 = 72.46% all percentages scale in acordane to the largest value
        var bar1centnormalized = (100/largest)*bar1cent;
        var bar2centnormalized = (100/largest)*bar2cent;
        var bar3centnormalized = (100/largest)*bar3cent;
        var bar4centnormalized = (100/largest)*bar4cent;
        var bar5centnormalized = (100/largest)*bar5cent;
        console.log('Normalized percentages: ',bar1centnormalized,bar2centnormalized,bar3centnormalized,bar4centnormalized,bar5centnormalized);
        
        //outputs percentages to the graph
        document.getElementById('bar1').style.width=(bar1centnormalized)+'%';
        document.getElementById('bar2').style.width=(bar2centnormalized)+'%';
        document.getElementById('bar3').style.width=(bar3centnormalized)+'%';
        document.getElementById('bar4').style.width=(bar4centnormalized)+'%';
        document.getElementById('bar5').style.width=(bar5centnormalized)+'%';

        this.colors();
    },
    colors:function(){//Generates random color
        var bar1='#'+Math.floor(Math.random()*16777215).toString(16);
        var bar2='#'+Math.floor(Math.random()*16777215).toString(16);
        var bar3='#'+Math.floor(Math.random()*16777215).toString(16);
        var bar4='#'+Math.floor(Math.random()*16777215).toString(16);
        var bar5='#'+Math.floor(Math.random()*16777215).toString(16);
        console.log('Bar1 color: ',bar1,' Bar2 color: ',bar2,' Bar3 color: ',bar3,' Bar4 color: ',bar4,'Bar5 color: ',bar5);
        document.getElementById('bar1').style.backgroundColor=bar1;
        document.getElementById('bar2').style.backgroundColor=bar2;
        document.getElementById('bar3').style.backgroundColor=bar3;
        document.getElementById('bar4').style.backgroundColor=bar4;
        document.getElementById('bar5').style.backgroundColor=bar5;
    },
}
</script>
</body>
</html>